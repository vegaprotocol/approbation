<style type="text/css">
    #filters {
        position: fixed;
        bottom: 0;
        right: 0;
        max-width: 300px;
        width: 30%;
        height: 300px;
    }

    #filters legend {
        background: #fff;
        display: block;
        border: 1px solid #000;
        margin-top: -0.5em;
        padding: 8px;
        font-size: 1.1em;
        font-weight: bold;
    }
    
    #filters fieldset {
        border: 1px solid #000;
        background: #fff;
    }
</style>

<script>
    function showAll() {
        document.querySelectorAll('.result').forEach(el => el.classList.remove('hide'));
    }

    function hideAll() {
        document.querySelectorAll('.result').forEach(el => el.classList.add('hide'));
    }

    function showCoveredAndUnknown() {
        hideAll();
        document.querySelectorAll('.tested.unknown').forEach(el => el.classList.remove('hide'));
    }

    function showCoveredAndFailing() {
        hideAll();
        document.querySelectorAll('.tested.fail').forEach(el => el.classList.remove('hide'));
    }

    function showMixedResults() {
        hideAll();
        document.querySelectorAll('.tested.mix').forEach(el => el.classList.remove('hide'));
    }

    function copyToClipboard(str) {
        const el = document.createElement('textarea');
        el.value = str;
        el.setAttribute('readonly', '');
        el.style.position = 'absolute';
        el.style.left = '-999px';
        document.body.appendChild(el);
        el.select();
        document.execCommand('copy');
        document.body.removeChild(el);
    };

    function copyIds() {
       const ids = Array.from(document.querySelectorAll('tr:not(.hide) td.code')).map(el => el.getAttribute('data-code')).join('\r\n- [ ] ') 
       copyToClipboard(ids)

       const el = document.getElementById('copy-button')
       el.textContent = 'ðŸ“‹ Copied'
       el.disabled = true

       setTimeout(() => {
        el.textContent = 'Copy visible IDs'
        el.disabled = false
       }, 1000)
    }

    function initialise() {
        document.getElementById('allCount').textContent = document.querySelectorAll('.result').length
        document.getElementById('unknownCount').textContent = document.querySelectorAll('.result.tested.unknown').length
        document.getElementById('failingCount').textContent = document.querySelectorAll('.result.tested.fail').length
        document.getElementById('mixedCount').textContent = document.querySelectorAll('.result.tested.mix').length

    }

    document.addEventListener("DOMContentLoaded", (event) => {
        initialise()
    })
</script>

<div id="filters">
    <form>
        <fieldset>
            <legend>Show only</legend>
                <p>
                    <label onClick={showAll()}><input type="radio" name="filter" value="unk"  selected /> Show all (<span id="allCount">0</span>)</label
                </p>
                <p>
                    <label onClick={showCoveredAndUnknown()}><input type="radio" name="filter" value="unk" /> Covered and unknown (<span id="unknownCount">0</span>)</label
                </p>
                <p>
                    <label onClick={showCoveredAndFailing()}><input type="radio" name="filter" value="fai" /> Covered and failing (<span id="failingCount">0</span>)</label
                </p>
                <p>
                    <label onClick={showMixedResults()}><input type="radio" name="filter" value="fai" /> Mixed pass/fail (<span id="mixedCount">0</span>)</label>
                </p>
                <p>
                    <button onClick={copyIds()} id="copy-button">Copy visible IDs</button>
                </p>
            </legend>
        </fieldset>
    </form>
</div>